

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/assets/apple-touch-icon.png">
  <link rel="icon" href="/assets/favicon-32x32.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Hin">
  <meta name="keywords" content="blog">
  
    <meta name="description" content="最近在搞 MuJoCo 仿真环境，决定在此记录下踩下的坑。">
<meta property="og:type" content="article">
<meta property="og:title" content="MuJoCo 踩坑日志">
<meta property="og:url" content="https://worranhin.github.io/2025/03/04/mujoco/index.html">
<meta property="og:site_name" content="Hin&#39;s 灵质空间">
<meta property="og:description" content="最近在搞 MuJoCo 仿真环境，决定在此记录下踩下的坑。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://worranhin.github.io/2025/03/04/mujoco/duck.jpg">
<meta property="article:published_time" content="2025-03-04T06:03:46.000Z">
<meta property="article:modified_time" content="2025-09-01T12:06:51.595Z">
<meta property="article:author" content="Hin">
<meta property="article:tag" content="工具">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://worranhin.github.io/2025/03/04/mujoco/duck.jpg">
  
  
  
  <title>MuJoCo 踩坑日志 | Hin&#39;s 灵质空间</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"worranhin.github.io","root":"/","version":"1.9.8","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":"#"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":null,"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":"0u2TP7o3z1tjjmNcUpRYFYff-MdYXbMMI","app_key":"6p7g6y54gThc1xpzjIEYhYzE","server_url":null,"path":"window.location.pathname","ignore_local":true},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null},"gtag":null,"woyaola":null,"cnzz":null},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  

  

  

  

  
    
  



  
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Hin's 灵质空间" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Hin&#39;s 灵质空间</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/atom.xml" target="_self">
                <i class="iconfont icon-rss-fill"></i>
                <span>feed</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('https://github.com/google-deepmind/mujoco/raw/main/banner.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">MuJoCo 踩坑日志</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-03-04 14:03" pubdate>
          2025年3月4日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          2.3k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          19 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">MuJoCo 踩坑日志</h1>
            
            
              <div class="markdown-body">
                
                <p>最近在搞 MuJoCo 仿真环境，决定在此记录下踩下的坑。</p>
<span id="more"></span>

<h2 id="抽搐的关节"><a href="#抽搐的关节" class="headerlink" title="抽搐的关节"></a>抽搐的关节</h2><p>在搭建 MuJoCo 仿真环境时发现添加关节后，它一直在抽搐，开始以为是摩擦、阻尼之类的没设好，问 copilot 也是建议去设置一下相关的参数。</p>
<blockquote>
<p>Copilot 是这么说的：<br>你的 robot_r1 关节一直在旋转，可能是因为缺少摩擦力或阻尼，导致关节在仿真中无法稳定下来。你可以尝试增加关节的摩擦力或调整阻尼参数来解决这个问题 …</p>
</blockquote>
<p>然而设置并调整了也没什么用。然后在 MuJoCo 的图形界面一番摸索后发现一些端倪。</p>
<p><img src="/2025/03/04/mujoco/image1.png" srcset="/img/loading.gif" lazyload alt="MuJoCo Simulate 界面"></p>
<p>如上图所示，我打开了 Convex Hull 选项，看到外面的框架的凸包，于是我开始怀疑是碰撞的问题，于是将抽搐的关节移出整个框架外，果然就不抽搐了。那接下来就是修改碰撞检测的问题了。</p>
<p>翻看文档，有这么两个参数：</p>
<blockquote>
<p>contype: int, “1”<br>This attribute and the next specify 32-bit integer bitmasks used for contact filtering of dynamically generated contact pairs. See Collision detection in the Computation chapter. Two geoms can collide if the contype of one geom is compatible with the conaffinity of the other geom or vice versa. Compatible means that the two bitmasks have a common bit set to 1.</p>
</blockquote>
<blockquote>
<p>conaffinity: int, “1”<br>Bitmask for contact filtering; see contype above.</p>
</blockquote>
<p><del>那么就把这个外框架的两个参数都设为 2 好了，其它的默认为 1 保持不变。</del></p>
<p>在 v3.2.5 版本时，如果都设为 0 的话就会闪退，不知道为什么。但是升级到 v3.3.0 版本后就不会了，所以按道理就是把这两个参数都设为零，就是不会检测碰撞了！</p>
<blockquote>
<p>需要注意的是，这个参数是 bitmasks 的形式，也就是说设为 3(0b0011) 的话，也是会和默认的 1(ob0001) 发生碰撞的。</p>
</blockquote>
<h2 id="凸包问题"><a href="#凸包问题" class="headerlink" title="凸包问题"></a>凸包问题</h2><p>其实跟上面提到的问题类似，其它的一些需要较高精度的物体，MuJoCo 默认只能将它们处理为凸包来实现碰撞检测，这就导致一些物体很难直接得到真实的仿真效果，而最显而易见的就是轴孔装配（Peg-in-hole）的问题了。</p>
<blockquote>
<p>官方文档的介绍：<a target="_blank" rel="noopener" href="https://mujoco.readthedocs.io/en/stable/computation/index.html#geom-distance">链接</a></p>
</blockquote>
<p>不妙的是，我正正是需要仿真一个类似轴孔装配的情况。如<a target="_blank" rel="noopener" href="https://github.com/google-deepmind/mujoco/discussions/738?sort=old">这篇讨论</a>所述，要处理这个问题，目前只能去做一个凸包分解的工作，而好消息是，有现成的算法和工具去做这个事情。</p>
<p>正如帖子中提到的，有一个叫做 <a target="_blank" rel="noopener" href="https://github.com/kevinzakka/obj2mjcf">obj2mjcf</a> 的工具可以自动将 obj 文件分解成多个凸包，并生成对应的 mjcf xml 文件。那么现在的问题就变成了，我要怎么从 solidworks 模型得到 obj 格式的文件了。
解决方法也很简单，就是整个 Blender 软件，导入 stl，导出 obj，结束。<del>就是这么简单而又粗暴。</del></p>
<p>具体的使用就不赘述了，不过就是有个小坑。不知道为什么有时用 Blender 导出的 obj 文件，在 obj2mjcf 处理的时候会报错，如下：</p>
<div class="code-wrapper"><pre><code class="hljs shell">Traceback (most recent call last):
  File &quot;D:\Program Files\python3\lib\runpy.py&quot;, line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File &quot;D:\Program Files\python3\lib\runpy.py&quot;, line 86, in _run_code
    exec(code, run_globals)
  File &quot;D:\Program Files\python3\Scripts\obj2mjcf.exe\__main__.py&quot;, line 7, in &lt;module&gt;
  File &quot;D:\Program Files\python3\lib\site-packages\obj2mjcf\cli.py&quot;, line 280, in main
    process_obj(obj_file, args)
  File &quot;D:\Program Files\python3\lib\site-packages\obj2mjcf\cli.py&quot;, line 138, in process_obj
    for line in f.readlines():
UnicodeDecodeError: &#x27;gbk&#x27; codec can&#x27;t decode byte 0xb9 in position 64: illegal multibyte sequence</code></pre></div>

<p>不过按下面的配置导出，且不保存 Blender 文件的话，就可以正常运行，可以稍微参考一下：</p>
<p><img src="/2025/03/04/mujoco/image2.png" srcset="/img/loading.gif" lazyload alt="导出 obj 配置项"></p>
<h2 id="微小零件的穿模问题"><a href="#微小零件的穿模问题" class="headerlink" title="微小零件的穿模问题"></a>微小零件的穿模问题</h2><p>继续添加一个自由的物体，发现它并没有按预期地被另一个固定的物体兜住，就像是直接穿模了一般掉到了地上。这真是太怪了。</p>
<p><del>最后发现是 timestep 设太高了，而且初始位置太高，导致加速度有点大，托不住。（后来发现并不是这个问题，而是需要设置 solimp 和 solref 的参数）</del></p>
<p>为了解决这个问题，需要去设置 MuJoCo 的 <a target="_blank" rel="noopener" href="https://mujoco.readthedocs.io/en/stable/modeling.html#solver-parameters">Solver Parameters</a>
这些参数决定了 MuJoCo 仿真器的接触约束行为。</p>
<p>在 MuJoCo 中，约束空间的动力学可以近似为下面的形式：</p>
<p>$$a_1 + d (bv+kr) &#x3D; (1-d) a_0$$</p>
<p>将上式移一下项，意义会更清晰：</p>
<p>$$a_1 &#x3D; (1-d) \cdot a_0 + d \cdot (-bv-kr)&#x3D; (1-d) \cdot a_0 + d \cdot a_{ref}$$</p>
<p>其中，$k$ 为刚度（stiffness）, $b$ 为阻尼系数（damping）, $d$ 为阻抗系数（Impedance）。
$a_1$ 为末状态加速度，$a_0$ 为原加速度，$a_{ref}$ 为参考加速度。$v$ 为速度，$r$ 为渗透深度。
上式也就是说约束状态下的加速度等于无约束状态下的加速度与参考加速度的加权平均。</p>
<p>而 Sover parameters 的设置由两部分组成——Impedance 和 Reference，分别对应着 $(k,b)$ 和 $d$ 的行为。</p>
<h3 id="Impedance"><a href="#Impedance" class="headerlink" title="Impedance"></a>Impedance</h3><p>Impdance 对应着 mjcf 文件中 geom 的 solimp 属性。格式为：</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">geom</span> <span class="hljs-attr">solimp</span>=<span class="hljs-string">&quot;0.9 0.05 0.001 0.5 2&quot;</span>&gt;</span></code></pre></div>
<p>五个参数分别对应 $d_0, d_{\mathrm{width}}, \mathrm{width}, \mathrm{midpoint}, \mathrm{power}$</p>
<p>这五个参数共同定义了 d 关于 r 的函数：</p>
<p>$$d(0) &#x3D; d_0, \quad d(\mathrm{width}) &#x3D; d_{\mathrm{width}}$$</p>
<p>函数图像与各参数的关系示意如下：</p>
<p><img src="https://mujoco.readthedocs.io/en/stable/_images/impedance.png" srcset="/img/loading.gif" lazyload alt="不同参数下的d(r)函数图像"></p>
<p>而关于 d 对接触行为的影响，官方的说法是对应着约束产生力的能力（ability to generate force）。简单来说，d 越大，约束能力越强。举两个极端的例子，若 $d&#x3D;0$ 的话，则表现为没有约束，$a_1 \equiv a_0$；
而如果 $d&#x3D;1$ 的话，$a_1 \equiv a_{ref}$，即接触行为只跟相对位置速度关系有关，加速度的变化在一瞬间完成。</p>
<p>然而上面仅仅是举例，事实上，MuJoCo 中 d 的取值范围是 $[0.0001, 0.9999]$</p>
<h3 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h3><p>Reference 指的是 reference acceleration ($a_{ref}$)，这部分控制参考加速度。
它决定了约束试图实现的动作（motion that constraint is trying to achieve）。</p>
<p>它的设置通过 solref 参数进行：</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">geom</span> <span class="hljs-attr">solref</span>=<span class="hljs-string">&quot;0.02 1&quot;</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">geom</span> <span class="hljs-attr">solref</span>=<span class="hljs-string">&quot;-10 -1&quot;</span>&gt;</span></code></pre></div>

<p>值得注意的是，这个参数的设置有两种形式，若设置的两个值为正数，则分别代表着时间常数（timeconst）和阻尼比（damp ratio）；
若两个值为负数，则其绝对值代表刚度（stiffness）和阻尼（damping）。</p>
<p>若设置时间常数和阻尼比的话，会在一定的缩放操作后按照质量-弹簧-阻尼器模型来计算出 k 和 b 的值，如下：</p>
<p>$$b &#x3D; 2 &#x2F; (d_{\mathrm{width}} \cdot timeconst)$$
$$k &#x3D; d(r) &#x2F; (d_{\mathrm{width}}^2 \cdot timeconst^2 \cdot dampratio^2)$$</p>
<p>需要注意，时间常数的值需要至少为模拟器的 timestep 参数的两倍大，否则系统可能会变得过于僵硬。
而阻尼比的话一般设为 1，对应着临界阻尼。而小于 1 对应欠阻尼。大于 1 对应过阻尼。</p>
<blockquote>
<p>什么是临界阻尼、欠阻尼和过阻尼可自行搜索或参考<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%98%BB%E5%B0%BC#%E7%B3%BB%E7%BB%9F%E8%A1%8C%E4%B8%BA">百科</a></p>
</blockquote>
<p>最重要的一点来了，也是解决本节提出问题的关键。因为约束状态下的加速度等于原加速度（无约束状态下的加速度）与参考加速度的加权平均，
而这两个加速度一般是反向的，那么两个准静态接触的物体总会平衡在某个渗透深度下，而这个深度可以推导出来，其结果为：</p>
<p>$$r &#x3D; a_0 \cdot (1 - d) \cdot timeconst^2 \cdot dampratio^2$$</p>
<p><strong>而如果这个平衡渗透深度比物体的厚度还要大，那么就势必会穿模啦！</strong> 
我的解决方法在下面总结处阐述，现在把这节收尾先。</p>
<p>正如上面提到的，除了设置时间常数和阻尼比外，还可以直接设置刚度和阻尼，但其实也会做一个缩放操作，如下：</p>
<p>$$b &#x3D; damping &#x2F; d_{width}$$</p>
<p>$$k &#x3D; stiffness \cdot d(r) &#x2F; d_{width}^2$$</p>
<p>而渗透深度如下：</p>
<p>$$r &#x3D; \frac{a_0 (1-d)}{stiffness}$$</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>那么知道原因后，解决方法也很明显了，通过改变各个参数，令 r 的值远小于物体的厚度即可。
我的做法是设置 solimp 的前两个参数为一样的，令 d 为常数。然后保持 dampratio 为 1，
将零件最小厚度的 1&#x2F;10 代入 r 中，即可算出 timeconst 的值了。然后验证一下，是否大于 timestep 的两倍，
如果不是，则需要减小 timestep 的值了。</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">geom</span> <span class="hljs-attr">friction</span>=<span class="hljs-string">&quot;1 0.005 0.01&quot;</span> <span class="hljs-attr">solimp</span>=<span class="hljs-string">&quot;0.99 0.99 0.001 0.1 2&quot;</span> <span class="hljs-attr">solref</span>=<span class="hljs-string">&quot;0.0014 1&quot;</span> <span class="hljs-attr">priority</span>=<span class="hljs-string">&quot;1&quot;</span>/&gt;</span></code></pre></div>

<p>这里还有一点需要注意的是优先级的问题，即上面的 priority 属性。接触的两个物体优先级不一样，那么就会采用高者数据设置；
而如果优先级一样则会计算一次加权平均，权重由 <code>solmix</code> 参数决定。（见<a target="_blank" rel="noopener" href="https://mujoco.readthedocs.io/en/stable/modeling.html#contact-parameters">这里</a>）</p>
<h2 id="步进电机"><a href="#步进电机" class="headerlink" title="步进电机"></a>步进电机</h2><blockquote>
<p>参考这个帖子：<a target="_blank" rel="noopener" href="https://github.com/google-deepmind/mujoco/issues/175">https://github.com/google-deepmind/mujoco/issues/175</a></p>
</blockquote>
<p>一个 Collaborator 给出了解决方案：</p>
<blockquote>
<p>You don’t need the callbacks. Just use a high gain position actuator on a joint with enough damping.</p>
</blockquote>
<p>也就是说使用一个高 kp 和足够 kv 的一个位置定位 shortcut ：</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">position</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;stepper&quot;</span> <span class="hljs-attr">joint</span>=<span class="hljs-string">&quot;slider&quot;</span> <span class="hljs-attr">kp</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">kv</span>=<span class="hljs-string">&quot;100&quot;</span> <span class="hljs-attr">inheritrange</span>=<span class="hljs-string">&quot;0.8&quot;</span> /&gt;</span></code></pre></div>

<h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><p>这篇文章可能持续更新，敬请期待。</p>
<blockquote>
<p>感觉 MuJoCo 的中文教程&#x2F;资料好少啊，而且官方文档写得有点太详细了。其实有点想法写一个简明入门指南，不过，再说吧。</p>
</blockquote>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/%E5%B7%A5%E5%85%B7/" class="print-no-link">#工具</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>MuJoCo 踩坑日志</div>
      <div>https://worranhin.github.io/2025/03/04/mujoco/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>Hin</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2025年3月4日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">
                  <span class="hint--top hint--rounded" aria-label="SA - 相同方式共享">
                    <i class="iconfont icon-cc-sa"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/03/20/chatgpt-on-wechat/" title="在微信部署 AI 助手 [未完成]">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">在微信部署 AI 助手 [未完成]</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/03/03/comment-on/" title="评论功能，开！">
                        <span class="hidden-mobile">评论功能，开！</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="waline"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#waline', function() {
      Fluid.utils.createCssLink('https://lib.baomitu.com/waline/2.14.1/waline.css')
      Fluid.utils.createScript('https://lib.baomitu.com/waline/2.14.1/waline.js', function() {
        var options = Object.assign(
          {"serverURL":"https://waline-for-my-blog-delta.vercel.app/","path":"window.location.pathname","meta":["nick","mail","link"],"requiredMeta":[],"lang":"zh-CN","emoji":["https://unpkg.com/@waline/emojis@1.2.0/bmoji","https://unpkg.com/@waline/emojis@1.2.0/bilibili"],"dark":"html[data-user-color-scheme=\"dark\"]","wordLimit":0,"pageSize":10},
          {
            el: '#waline',
            path: window.location.pathname
          }
        )
        Waline.init(options);
        Fluid.utils.waitElementVisible('#waline .vcontent', () => {
          var imgSelector = '#waline .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       © 2024 Hin. | Powered by <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>, themed with   <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a>
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="leancloud-site-pv-container" style="display: none">
        总访问量 
        <span id="leancloud-site-pv"></span>
         次
      </span>
    
    
      <span id="leancloud-site-uv-container" style="display: none">
        总访客数 
        <span id="leancloud-site-uv"></span>
         人
      </span>
    
    

  

</div>

  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script defer src="/js/leancloud.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  ﻿

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
